<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Adding a Second SSID</title>
  <meta name="description" content="This guide will show you how to set up a second (and in turn multiple) SSID for your network.">
  <link rel="icon" type="image/png" href="/images/favicon.ico">
  <link rel="stylesheet" href="/css/material.css">
  <link rel="stylesheet" href="/css/site.css">
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:400,700,300' type='text/css'>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="canonical" href="https://cucumberwifi.io/tutorials/2016/03/02/openwrt-adding-second-ssid.html">
  <link rel="alternate" type="application/rss+xml" title="Full-stack Wi-Fi Platform" href="https://cucumberwifi.io/feed.xml" />

  <script src="/js/material.js"></script>

</head>


<body>

  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
  <header class="mdl-layout__header mdl-layout__header--scroll mdl-shadow--4dp">
    <div class="mdl-layout__header-row">
      <!-- Title -->
      <div class="ct-logo">
        <a href="/"><img src="/images/pages/cucumber-wifi.svg"></a>
      </div>
      <!-- Add spacer, to align navigation to the right -->
      <div class="mdl-layout-spacer"></div>
      <!-- Navigation. We hide it in small screens. -->
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        <a class="mdl-navigation__link" href="/discover/">Discover</a>
        <a style="cursor:pointer;" id="features-list" class="mdl-navigation__link">Features</a>
        <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="features-list">
          <a href="/features/management/"><li class="mdl-menu__item">Management</li></a>
          <a href="/features/networks/"><li class="mdl-menu__item">Networks</li></a>
          <a href="/features/branding/"><li class="mdl-menu__item">Branding</li></a>
          <a href="/features/reports/"><li class="mdl-menu__item">Reports</li></a>
          <a href="/features/integrations/"><li class="mdl-menu__item">Integrations</li></a>
          <a href="/features/guests/"><li class="mdl-menu__item">Guest Login</li></a>
        </ul>
        <a class="mdl-navigation__link" href="/compatible-hardware/">Devices</a>
        <a class="mdl-navigation__link" href="/plans/">Plans</a>
        <a class="mdl-navigation__link" target="_blank" href="https://discuss.cucumberwifi.io/">Discuss</a>
        <a class="mdl-navigation__link" href="https://my.ctapp.io/#/create">Sign-up</a>
        <a class="mdl-navigation__link" href="https://my.ctapp.io/#/login">Login</a>
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer mdl-layout--small-screen-only mdl-shadow--4dp">
    <nav class="mdl-navigation">
      <span class="sidebar-logo"><img src="/images/pages/cucumber-wifi.svg"></span>
      <a class="mdl-navigation__link" href="/discover/">Discover</a>
      <span class="mdl-navigation__link" href="/discover/">Features</span>
      <hr>
      <div class="navigation-subheader-list">
        <a class="mdl-navigation__link" href="/features/management">Management</a>
        <a class="mdl-navigation__link" href="/features/networks/">Networks</a>
        <a class="mdl-navigation__link" href="/features/branding/">Branding</a>
        <a class="mdl-navigation__link" href="/features/reports/">Reports</a>
        <a class="mdl-navigation__link" href="/features/integrations/">Integrations</a>
        <a class="mdl-navigation__link" href="/features/guests">Guest Login</a>
        <a class="mdl-navigation__link" href="/compatible-hardware/">Devices</a>
      </div>
      <hr>
      <a class="mdl-navigation__link" href="/plans/">Plans</a>
      <a class="mdl-navigation__link" target="_blank" href="https://discuss.cucumberwifi.io/">Discuss</a>
      <a class="mdl-navigation__link" href="https://my.ctapp.io/#/create">Sign-up</a>
      <a class="mdl-navigation__link" href="https://my.ctapp.io/#/login">Login</a>
    </nav>
  </div>
  <main class="mdl-layout__content">
    <div class="community mdl-grid">
  <div class="community-post center-cell mdl-cell mdl-cell--9-col mdl-card mdl-shadow--4dp">
      <h1>Adding a Second SSID</h1>
      <p>Mar 2, 2016</p>
    <p>This guide will show you how to set up a second (and in turn multiple) SSID for your network.</p>

<p>In this example we will be creating an SSID for guest access, separate from your own private SSID.</p>

<h2 id="ssh-to-your-openwrt-device">SSH to your OpenWRT device</h2>

<p>If you are using Windows then start PuTTY and click Session on the left side, select SSH from the options, and then enter in the IP Address of your OpenWRT box into the Host Name field.</p>

<p>Once you’ve done this just click on Open to start up the SSH connection.</p>

<div class="mdl-typography--text-center">
  <img src="/images/community/tutorials/openwrt/puttyconfig.png" width="400px" />
</div>

<p>If you are connecting via terminal, then just SSH to your OpenWRT device using the following command, where 192.168.1.1 is your OpenWRT device’s IP address.</p>

<p><code>ssh root@192.168.1.1</code></p>

<h2 id="create-a-new-network-interface">Create a new network interface</h2>

<p>First we need to define a new interface in our network config, so run the following command:</p>

<p><code>vi /etc/config/network</code></p>

<p>Now that you have the network config file open, we can add in the following new interface which we are going to name ‘public’.</p>

<pre><code>config 'interface' 'public'
        option 'proto' 'static'
        option 'ipaddr' '10.0.0.1'
        option 'netmask' '255.255.255.0'
</code></pre>

<h2 id="create-a-new-network">Create a new network</h2>

<p>Next up we want to create the new guest network/SSID. Run the following command:</p>

<p><code>vi /etc/config/wireless</code></p>

<p>Now you can simply copy and paste the existing ‘wifi-iface’ section and change a couple things.</p>

<p><strong>option ‘device’</strong> — Change this to the name of the radio you want to broadcast this network.</p>

<p><strong>option ‘network’</strong> — Change this to the name of the interface you created previously.</p>

<p><strong>option ‘ssid’</strong> — Change to the name you want guests to see when looking for your network.</p>

<p><strong>option ‘isolate’ 1</strong> — add this to the config to prevent clients on the network from connecting to each other.</p>

<p>You should end up with something like the following:</p>

<pre><code>config 'wifi-iface'
        option 'device'     'wifi0'
        option 'mode'       'ap'
        option 'network'    'public'
        option 'ssid'       'Guest_WiFi'
        option 'encryption' 'none'
        option 'isolate'    1
</code></pre>

<h2 id="define-a-new-dhcp-pool">Define a new DHCP pool</h2>

<p>If you want DHCP on your guest network, then we will need to make a couple additions to the DHCP config.</p>

<p>Run the following command:</p>

<p><code>vi /etc/config/dhcp</code></p>

<p>This will open the DHCP config where you will need to add in the following:</p>

<pre><code>config 'dhcp' 'public'
        option 'interface'  'public'
        option 'start'      '50'
        option 'limit'      '200'
        option 'leasetime'  '1h'
</code></pre>

<p>Set option ‘interface’ to the name of the network interface you created at the start.</p>

<h2 id="define-firewall-rules">Define firewall rules</h2>

<p>Now we need to secure the public guest network. So run the following command to open the firewall config:</p>

<p><code>vi /etc/config/firewall</code></p>

<p>To err on the side of caution, we want to allow guests to the web via http and https, but do not want them to have access to the LAN or anything else.</p>

<p>Add a new zone section for the ‘public’ interface. We are going to allow SSH, DNS and DHCP to the guests, and allow guests http and https to the outside world. Then we want to block everything else.</p>

<pre><code>config zone                                     
      option name 'public'                 
      option network 'public'              
      option forward 'REJECT'             
      option output 'ACCEPT'              
      option input 'REJECT'

config forwarding                               
      option src 'public'                  
      option dest 'wan'

config rule                                     
      option src 'public'                      
      option src_port '67-68'                 
      option dest_port '67-68'                
      option proto 'udp'                      
      option target 'ACCEPT'                  
      option name 'Allow DHCP request'        

config rule                                     
      option src 'public'                      
      option dest_port '53'                   
      option proto 'tcpudp'                   
      option target 'ACCEPT'                  
      option name 'Allow DNS Queries'         

config rule                                     
      option src 'public'                      
      option dest 'lan'                       
      option name 'Deny Guest on LAN'        
      option proto 'all'                      
      option target 'DROP'                    

config rule                                     
      option target 'ACCEPT'                  
      option src 'public'                      
      option dest 'wan'                       
      option name 'Allow Guest on WAN http'      
      option proto 'tcp'                      
      option dest_port '80'                   

config rule                                 
      option target 'ACCEPT'              
      option src 'public'                  
      option dest 'wan'                      
      option name 'Allow Guest on WAN https'  
      option proto 'tcp'                  
      option dest_port '443'

config rule                                     
      option src 'public'                      
      option dest 'wan'                       
      option name 'Deny Guest on WAN'
      option proto 'all'                  
      option target 'DROP'
</code></pre>

<p>After making all of these changes, you will need to either restart the processes or reboot your box.</p>

<p>To restart the processes run the following commands:</p>

<pre><code>/etc/init.d/dnsmasq restart
/etc/init.d/firewall restart
/etc/init.d/network restart
</code></pre>

<h3 id="optional-limit-guest-broadband-connection">(Optional) Limit guest broadband connection</h3>

<p>If you are running a public connection for users it is advised, but not necessary, to limit their broadband usage to limit abuse of your network.
There is a handy package you can install to manage this easily. Run the following command:</p>

<p><code>opkg install wshaper</code></p>

<p>Once the package is installed, run the following command:</p>

<p><code>vi /etc/config/wshaper</code></p>

<p>Set the network option to the name of the network interface you created at the start, and adjust the downlink and uplink options to the download and upload speed limits you want to apply (in kbit).</p>

<pre><code>config wshaper 'settings'
      option network 'public'
      option downlink '1024'
      option uplink '512'
</code></pre>

<hr />

<p><em>Cucumber Tony is a cloud based WiFi management platform for businesses. The firmware gives consumer-grade WiFi access points enterprise-like capabilities. Or you can utilise the captive portal solution with your existing infrastructure. Create a free account and check it here <a href="https://cucumberwifi.io">cucumberwifi.io</a></em></p>

<div class="mdl-typography--text-center">

<h2>Come join Cucumber</h2>

<a href="https://my.ctapp.io/#/create" class="button success dst">Sign Up</a><br />

<p>Sign-up for Cucumber Tony, it's free for unlimited access points :)</p>

<hr />

</div>

  </div>
</div>

    <footer class="mdl-mega-footer">

  <div class="mdl-grid">
    <div class="center-cell mdl-cell mdl-cell--10-col">

      <div class=" mdl-mega-footer__middle-section">

        <div class="mdl-mega-footer__drop-down-section">
          <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
          <h1 class="mdl-mega-footer__heading">Product</h1>
          <ul class="mdl-mega-footer__link-list">
            <li><a href="/plans/">Plans</a></li>
            <li><a href="/discover/">Discover</a></li>
            <li><a href="/compatible-hardware/">Compatible Hardware</a></li>
          </ul>
        </div>

        <div class="mdl-mega-footer__drop-down-section">
          <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
          <h1 class="mdl-mega-footer__heading">Helpful</h1>
          <ul class="mdl-mega-footer__link-list">
            <li><a href="http://docs.polkaspots.apiary.io/" target="_blank">API</a></li>
            <li><a href="http://docs.cucumberwifi.io/" target="_blank">Docs</a></li>
            <li><a href="http://status.ctapp.io/" target="_blank">Status</a></li>
            <li><a href="https://discuss.cucumberwifi.io/" target="_blank">Discuss</a></li>
            <li><a href="/community/tutorials/">Tutorials</a></li>
          </ul>
        </div>

        <div class="mdl-mega-footer__drop-down-section">
          <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
          <h1 class="mdl-mega-footer__heading">Company</h1>
          <ul class="mdl-mega-footer__link-list">
            <li><a href="https://medium.com/guest-wifi" target="_blank">Blog</a></li>
            <li><a href="/about/">About Us</a></li>
            <li><a href="/contact/">Contact Us</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
          </ul>
        </div>

        <!-- <div class="mdl-mega-footer__drop-down-section">
          <input class="mdl-mega-footer__heading-checkbox" type="checkbox" checked>
          <h1 class="mdl-mega-footer__heading">FAQ</h1>
          <ul class="mdl-mega-footer__link-list">
            <li><a href="#">Questions</a></li>
            <li><a href="#">Answers</a></li>
            <li><a href="#">Contact us</a></li>
          </ul>
        </div> -->

      </div>

      <div class="mdl-mega-footer__middle-section footer-social">
        <a href="https://twitter.com/cucumbertony" target="_blank">
          <img class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect" src="/images/pages/social/twitter.png"
        </a>
        <a href="https://www.linkedin.com/company/cucumber-tony" target="_blank">
          <img class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect" src="/images/pages/social/linkedin.png"
        </a>
        <a href="https://www.facebook.com/cucumbertony/" target="_blank">
          <img class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect" src="/images/pages/social/facebook.png"
        </a>
        <a href="https://www.youtube.com/channel/UCpPkREGXYrlontKXB3B3t9A" target="_blank">
          <img class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect" src="/images/pages/social/youtube.png"
        </a>
      </div>

    </div>
  </div>

</footer>

  </main>
</div>


</body>

</html>
